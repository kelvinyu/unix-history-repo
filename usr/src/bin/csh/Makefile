#	@(#)Makefile	5.20 (Berkeley) %G%
#
# C Shell with process control; VM/UNIX VAX Makefile
# Bill Joy UC Berkeley; Jim Kulp IIASA, Austria
#
# To profile, put -DPROF in DEFS and -pg in CFLAGS, and recompile.

PROG=	csh
CFLAGS+=-fcombine-regs -fstrength-reduce -DFILEC -DNLS \
	-DSHORT_STRINGS -DTERMIOS -DVFORK -I${.CURDIR} -I.
SRCS=	sh.c sh.char.c sh.dir.c sh.dol.c sh.err.c sh.exec.c sh.exp.c \
	sh.file.c sh.func.c sh.glob.c sh.hist.c sh.init.c sh.lex.c \
	sh.misc.c sh.parse.c sh.print.c sh.proc.c sh.sem.c sh.set.c \
	sh.time.c tc.alloc.c tc.printf.c tc.str.c tc.const.c
.PATH:	${.CURDIR}/../../lib/libc/stdio
MAN1=	csh.0
MLINKS=	csh.1 limit.1 csh.1 alias.1 csh.1 bg.1 csh.1 dirs.1 csh.1 fg.1 \
	csh.1 foreach.1 csh.1 history.1 csh.1 jobs.1 csh.1 popd.1 \
	csh.1 pushd.1 csh.1 rehash.1 csh.1 repeat.1 csh.1 suspend.1 \
	csh.1 stop.1 csh.1 source.1
CLEANFILES+=sh.err.h tc.const.h

tc.const.h: sh.err.h

sh.err.h: sh.err.c
	@rm -f $@
	@echo '/* Do not edit this file, make creates it. */' > $@
	@echo '#ifndef _h_sh_err' >> $@
	@echo '#define _h_sh_err' >> $@
	egrep 'ERR_' ${.CURDIR}/$*.c | egrep '^#define' >> $@
	@echo '#endif /* _h_sh_err */' >> $@

tc.const.h: tc.const.c
	@rm -f $@
	@echo '/* Do not edit this file, make creates it. */' > $@
	${CC} -E ${CFLAGS} ${.CURDIR}/$*.c | egrep 'Char STR' | \
	    sed -e 's/Char \([a-zA-Z0-9_]*\)\(.*\)/extern Char \1[];/' | \
	    sort >> $@

.depend: sh.err.h tc.const.h

.include <bsd.prog.mk>
